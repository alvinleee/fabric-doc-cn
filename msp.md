# Membership Service Providers(MSP)

该文件用于提供有关*MSP*设置和最佳做法的详细信息。

会员服务提供商（*MSP*）是旨在提供会员操作架构抽象的组件。

特别是，*MSP*抽取出签发和验证证书以及用户认证背后的所有加密机制和协议。*MSP*可以定义自己的身份概念，以及这些身份管理的规则（身份验证）和验证（签名生成和验证）。

一个*Hyperledger Fabric*区块链网络可以由一个或多个*MSP*来管理。这提供了会员操作的模块化，以及跨越不同会员标准和体系结构之间的互通性。

在本文档的其余部分，我们详细说明了*Hyperledger Fabric*所支持的MSP实现的设置，并讨论了关于其使用的最佳实践。。

## MSP 设置

要配置*MSP*的一个实例，需要在每个对等节点和排序节点（在启用对等节点和排序节点签名时）的本地指定其配置，并在通道上启用对等节点，排序节点，客户端身份验证和所有通道成员各自的签名验证。

首先，对于每一个*MSP*都需要指定其名称，以便在网络中引用这个*MSP*（例如*msp1*，*org2*和*org3.divA*）。这个名称就是在通道中被引用的代表联盟，组织或组织部门的*MSP*的成员规则里的名称。这也称为*MSP*标识符或*MSP ID*。MSP标识符对于每个MSP实例都是唯一的。例如，在生成系统通道时被检测到有两个具有相同标识符的MSP实例，则排序节点的设置将会失败。

在*MSP*的默认实现的情况下，需要指定一组参数来允许身份（证书）验证和签名验证。这些参数由*RFC5280*推导出来， 其中包括：

* 自签名（X.509）证书列表构成可信根。

* 一个X.509证书的列表，用来表示用于证书验证的中间CA; 这些证书应该可以通过可信根中的一个证书来证明; 中间CA是可选参数

* 拥有一个可验证证书路径的，正好是可以代表该*MSP*管理员的可信根证书中的一个的，一个X.509证书的列表;这些证书的拥有者就有权更改*MSP*的配置。(例如，根CAs，中间CAs)

* 一个*MSP*中有效成员的组织单位列表应该包含在他们X.509证书中；这是一个可选的配置参数。例如，当有多个组织使用同一个可信根和中间*CA*并且为他们的成员保留OU字段时使用。

* 证书撤销列表中的每一个都和所列出的(中间或者根)*MSP*证书授权中的一个相对应；这是一个可选参数。

* 自签名（X.509）证书的列表，构成*TLS*证书的*TLS*可信根。

* 一个X.509证书的列表，用于表示提供商认为的中间*TLS CA*; 这些证书应该通过*TLS*可信根中的一个证书进行认证; 中间CA是可选参数。

一个*MSP*的有效身份需要满足以下条件：
* 它们是X.509证书的形式，具有可验证证书路径，并正好是可信根证书中的一个。

* 它们不在任何一个证书撤销列表*CRL*中。

* 在它们的X.509证书结构中的*OU*字段中列出一个或多个*MSP*配置中的组织单元。

关于当前*MSP*部署中身份有效性的更多信息，请参阅 
[*MSP*身份验证规则](http://hyperledger-fabric.readthedocs.io/en/latest/msp-identity-validity-rules.html)

除了验证相关的参数外，为了使MSP启用实例化的节点进行签名或认证，需要指定：

* 用于由节点签名的签名密钥（目前只支持*ECDSA*密钥）。
* 该节点的X.509证书，是通过MSP验证参数验证的有效身份。

需要特别注意的是，*MSP*身份永远不会过期; 它们只能通过将其添加到适当的*CRL*来撤销。此外，目前还不支持强制撤销*TLS*证书。